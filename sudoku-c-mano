#include <stdio.h>
#include <stdlib.h>
#include <time.h>

#define GRID_SIZE 9 //taille de la grille (9 par 9)
#define LIST_SIZE 9 //taille de la liste

int list[LIST_SIZE] = {1, 2, 3, 4, 5, 6, 7, 8, 9};

void shuffleList() //FONCTION QUI VA MÉLANGER LA SUITE DE NOMBRE
{
    int i, j, temp;
    for (i = 0; i < LIST_SIZE - 1; i++) { //parcourir la liste des nombres à mélanger
        j = rand() % (LIST_SIZE - i) + i;
        //algo de fisher yates pour mélanger les nombres
        temp = list[i];
        list[i] = list[j];
        list[j] = temp;
    }
}

int main() { //FONCTION PRINCIPALE QUI VA SUPPRIMER DES CASES, AFFICHER LA GRILLE DE BASE PUIS LA SOLUTION
    srand(time(NULL));
    shuffleList();

    int grid[GRID_SIZE][GRID_SIZE] = {0}; //création du tableau en 2D
    int i, j, k; //variables pour les itérations
    for (i = 0; i < GRID_SIZE; i++) {
        for (j = 0; j < GRID_SIZE; j++) {
            k = (i * 3 + i / 3 + j) % LIST_SIZE; // Calcul de la position du prochain numéro à placer
            grid[i][j] = list[k]; // Placement du numéro dans la grille
        }
    }

    int solvedGrid[GRID_SIZE][GRID_SIZE]; //on copie la grid dans solvedGrid

    for (i = 0; i < GRID_SIZE; i++) {
        for (j = 0; j < GRID_SIZE; j++) {
            solvedGrid[i][j] = grid[i][j]; //on parcourt la grid puis on copie les éléments dans solvedGrid. Au final on
            //va venir compléter les cases = 0 par les chiffres manquants
        }
    }

    int num_to_remove  = 1; //30 nombres doivent être supprimés

    while (num_to_remove > 0) {
        int row = rand() % 9; //choisir une ligne au hasard
        int col = rand() % 9; //choisir une colone au hasard
        if (grid[row][col] != 0) { //si la grille avec la colone + ligne choisies est différent de 0
            grid[row][col] = 0; // on met la case à 0
            num_to_remove--; //décrémentation pour arriver enfin à 30 nombres supprimés
        }
    }

    for (i = 0; i < GRID_SIZE; i++) { // boucle for qui va afficher la grid
        if(i % 3 == 0)
            printf("+-------+-------+-------+\n");
        for (j = 0; j < GRID_SIZE; j++) {
            if(j % 3 == 0)
                printf("| ");
            printf("%d ", grid[i][j]);
        }
        printf("| \n");
    }
    printf("+-------+-------+-------+\n");

    /*on demande à l'utilisateur de remplir les cases vides, si la case est remplie par un chiffre autre que 0 alors on lui
     * dit que la case est remplie, on affiche la grille et on redemande de remplir une case. Si la case qui est vide a été remplie par
     * un nombre qui n'est pas celui dans solved grille alors l'on dit que ce n'est pas le bon nombre, on affiche la grille puis on
     * redemande de completer une case, quand la grille est complétée on dit bravo*/

    int row, col, num;
    int count = 0;
    while (count < 1) {
        printf("Enter the row: ");
        scanf("%d", &row);
        printf("Enter the col: ");
        scanf("%d",&col);
        printf("Enter the number: ");
        scanf("%d",&num);
        if (grid[row][col] != 0) {
            printf("This cell is already filled.\n");
            printf("Here is the current grid:\n");
            for (i = 0; i < GRID_SIZE; i++) {
                if(i % 3 == 0)
                    printf("+-------+-------+-------+\n");
                for (j = 0; j < GRID_SIZE; j++) {
                    if(j % 3 == 0)
                        printf("| ");
                    printf("%d ", grid[i][j]);
                }
                printf("| \n");
            }
            printf("+-------+-------+-------+\n");
        } else if (num != solvedGrid[row][col]) {
            printf("Wrong number.\n");
            printf("Here is the current grid:\n");
            for (i = 0; i < GRID_SIZE; i++) {
                if(i % 3 == 0)
                    printf("+-------+-------+-------+\n");
                for (j = 0; j < GRID_SIZE; j++) {
                    if(j % 3 == 0)
                        printf("| ");
                    printf("%d ", grid[i][j]);
                }
                printf("| \n");
            }
            printf("+-------+-------+-------+\n");
        } else {
            grid[row][col] = num;
            count++;
            printf("Here is the current grid:\n");
            for (i = 0; i < GRID_SIZE; i++) {
                if(i % 3 == 0)
                    printf("+-------+-------+-------+\n");
                for (j = 0; j < GRID_SIZE; j++) {
                    if(j % 3 == 0)
                        printf("| ");
                    printf("%d ", grid[i][j]);
                }
                printf("| \n");
            }
            printf("+-------+-------+-------+\n");
        }
    }
    printf("Congrats! You solved the puzzle.\n");

    system("pause");

    return 0;
}
